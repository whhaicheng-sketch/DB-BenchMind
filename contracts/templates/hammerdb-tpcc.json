{
  "$schema": "https://db-benchmind.dev/schemas/template/v1.json",
  "id": "hammerdb-tpcc",
  "name": "HammerDB TPROC-C",
  "description": "Standard TPC-C benchmark test (OLTP transaction processing)",
  "tool": "hammerdb",
  "database_types": ["mysql", "postgresql", "oracle", "sqlserver"],
  "version": "1.0.0",
  "parameters": {
    "threads": {
      "type": "integer",
      "label": "Number of virtual users",
      "default": 10,
      "min": 1,
      "max": 1000
    },
    "time": {
      "type": "integer",
      "label": "Runtime (minutes)",
      "default": 10,
      "min": 1,
      "max": 1440
    },
    "warehouses": {
      "type": "integer",
      "label": "Number of warehouses",
      "default": 1,
      "min": 1,
      "max": 1000
    },
    "rampup_time": {
      "type": "integer",
      "label": "Ramp up time (minutes)",
      "default": 2,
      "min": 0,
      "max": 60
    },
    "tpc_mode": {
      "type": "enum",
      "label": "TPC mode",
      "default": "true",
      "options": ["true", "false"]
    }
  },
  "command_template": {
    "prepare": "hammerdbcli autobuild \"dbset db {db_type}; dbset bm TPC-C; diset connection {connection_config}; diset tpcc {db_type}_count_ware {warehouses}; buildschema; wait for completion\"",
    "run": "hammerdbcli autobuild \"dbset db {db_type}; dbset bm TPC-C; diset connection {connection_config}; diset tpcc {db_type}_driver timed; diset tpcc {db_type}_rampup {rampup_time}; diset tpcc {db_type}_duration {time}; vuset vu {threads}; vucreate; vurun; vudestroy\"",
    "cleanup": "hammerdbcli autobuild \"dbset db {db_type}; dbset bm TPC-C; diset connection {connection_config}; dropschema\""
  },
  "output_parser": {
    "type": "regex",
    "patterns": {
      "tpm": "TPM\\s*:\\s*(\\d+\\.?\\d*)",
      "nopm": "NOPM\\s*:\\s*(\\d+\\.?\\d*)",
      "efficiency": "Efficiency\\s*:\\s*(\\d+\\.?\\d*)%",
      "errors": "Errors\\s*:\\s*(\\d+)"
    }
  }
}
